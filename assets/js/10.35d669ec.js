(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{390:function(e,t,s){e.exports=s.p+"assets/img/julia.cea00060.jpg"},391:function(e,t,s){e.exports=s.p+"assets/img/duplicate-plugin.ecb61b19.png"},392:function(e,t,s){e.exports=s.p+"assets/img/yelling.2ce13a40.jpg"},419:function(e,t,s){"use strict";s.r(t);var a=s(9),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[a("RouterLink",{attrs:{to:"/zh/2020/01/01/caveats-about-building-npm-packages/"}},[e._v("繁體中文")]),e._v(" | English")],1),e._v(" "),a("p",[e._v("Let's review the dumb things I've done when I was building npm packages. Here're three caveats might help you.")]),e._v(" "),a("h2",{attrs:{id:"duplicate-npm-package"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#duplicate-npm-package"}},[e._v("#")]),e._v(" Duplicate npm package")]),e._v(" "),a("p",[e._v("It's the dump thing happened when I was writing "),a("a",{attrs:{href:"https://github.com/billyyyyy3320/vuepress-plugin-disqus-comment",target:"_blank",rel:"noopener noreferrer"}},[e._v("vuepress-plugin-disqus-comment"),a("OutboundLink")],1),e._v(". The plugin name could've been "),a("code",[e._v("vuepress-plugin-disqus")]),e._v(". I pressed down "),a("code",[e._v("yarn publish")]),e._v(" jovially when I finished. But looked at my terminal:")]),e._v(" "),a("p",[a("code",[e._v('error Couldn\'t publish package: "https://registry.yarnpkg.com/vuepress-plugin-disqus: You do not have permission to publish \\"vuepress-plugin-disqus\\". Are you logged in as the correct user?"')])]),e._v(" "),a("img",{staticClass:"align-center",attrs:{src:s(390),width:"500px"}}),e._v(" "),a("p",[e._v("Stunned, but I figured it out eventually. I went to "),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("npmjs.com"),a("OutboundLink")],1),e._v(" to search for "),a("code",[e._v("vuepress-plugin-disqus")]),e._v(", as I expected:")]),e._v(" "),a("p",[a("img",{attrs:{src:s(391),alt:"Duplicate plugin"}})]),e._v(" "),a("p",[e._v("Someone's built this plugin...")]),e._v(" "),a("p",[e._v("Please head "),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("npmjs.com"),a("OutboundLink")],1),e._v(" to check whether a relevant package is built before you start burying yourself in work.\nI'm not telling you don't work on it, but you can at least consider whether making PRs to improve existed package or building another one from scratch.")]),e._v(" "),a("h2",{attrs:{id:"leverage-npm-link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#leverage-npm-link"}},[e._v("#")]),e._v(" Leverage "),a("code",[e._v("npm link")])]),e._v(" "),a("p",[e._v("Well, this is a more stupid thing. I wrote demo which required local program in my package, such as "),a("code",[e._v('require("../../src/index"')]),e._v(". Since demo worked as I've expected, I published it. I'd just found out it can't work at all when I installed it to another project. Check "),a("code",[e._v("package.json")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"vuepress-plugin-disqus-comment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Adding Disqus comments to VuePress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"keywords"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"comment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"disqus"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"plugin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"vuepress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"homepage"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://vuepress-plugin-disqus.netlify.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"bugs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com/newsbielt703/vuepress-plugin-disqus/issues"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"repository"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"git"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"newsbielt703/vuepress-plugin-disqus"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"license"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"MIT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"author"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Billyyyyy3320 <newsbielt703@gmail.com>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"main"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"build:docs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"vuepress build docs --temp docs/.temp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"dev:docs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"vuepress dev docs --temp docs/.temp"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"vue-disqus"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"^3.0.5"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"devDependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"vuepress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"^1.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"vuepress-types"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"^0.3.0"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("And here's my directory:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("├── LICENSE\n├── README.md\n├── docs\n│   └── README.md\n├── package.json\n├── src\n│   ├── enhanceAppFile.js\n│   └── index.js\n└── yarn.lock\n")])])]),a("p",[e._v("The path "),a("code",[e._v("main")]),e._v(" indicated wasn't right at all !!")]),e._v(" "),a("img",{staticClass:"align-center",attrs:{src:s(392),width:"400px"}}),e._v(" "),a("p",[e._v("Leveraging "),a("a",{attrs:{href:"https://docs.npmjs.com/cli/link",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm link"),a("OutboundLink")],1),e._v(" or "),a("a",{attrs:{href:"https://yarnpkg.com/lang/en/docs/cli/link/",target:"_blank",rel:"noopener noreferrer"}},[e._v("yarn link"),a("OutboundLink")],1),e._v(" can link a package into another project. I could've noticed that.")]),e._v(" "),a("p",[e._v("You may not make this low-level mistake, but remember to test you package with "),a("code",[e._v("npm link")]),e._v(", "),a("code",[e._v("yarn link")]),e._v(" or even "),a("a",{attrs:{href:"https://github.com/whitecolor/yalc",target:"_blank",rel:"noopener noreferrer"}},[e._v("Yalc"),a("OutboundLink")],1),e._v(" before publishing.")]),e._v(" "),a("h2",{attrs:{id:"npmignore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npmignore"}},[e._v("#")]),e._v(" "),a("code",[e._v(".npmignore")])]),e._v(" "),a("p",[e._v("There're three approaches to ignore files,"),a("code",[e._v(".gitignore")]),e._v(","),a("code",[e._v(".npmignore")]),e._v(" or the "),a("code",[e._v("file")]),e._v(" property in "),a("code",[e._v("package.json")]),e._v(".")]),e._v(" "),a("p",[e._v("Suppose the "),a("code",[e._v(".gitignore")]),e._v(" is something like:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("node_modules\nmy_secret\n")])])]),a("p",[a("code",[e._v("node_modules")]),e._v(" and "),a("code",[e._v("my_secret")]),e._v(" will be ignore not only by git but also by npm.")]),e._v(" "),a("p",[e._v("Unless there's "),a("code",[e._v(".npmignore")]),e._v(" in your package. Let’s say you’ve written tests. Git should save the tests, whereas npm shouldn't upload them. You might want to use "),a("code",[e._v(".npmignore")]),e._v(" in this case. If you write:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("tests\n")])])]),a("p",[e._v("Oops, "),a("code",[e._v("my_secret")]),e._v(" will be upload. "),a("code",[e._v(".gitignore")]),e._v(" won't be referenced when "),a("code",[e._v(".npmignore")]),e._v(" exists, so make sure you've put all the files or dirs which you want to exclude into "),a("code",[e._v(".npmignore")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("my_secret\ntests\n")])])]),a("p",[e._v("It's a big deal. I got to know it because of "),a("a",{attrs:{href:"https://medium.com/@jdxcode/for-the-love-of-god-dont-use-npmignore-f93c08909d8d",target:"_blank",rel:"noopener noreferrer"}},[e._v("this article"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("It's worth to mention that you don't need to add "),a("code",[e._v("node_modules")]),e._v(" to "),a("code",[e._v(".npmignore")]),e._v(" since it'll be ignore automatically. Head "),a("a",{attrs:{href:"https://docs.npmjs.com/misc/developers#keeping-files-out-of-your-package",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm"),a("OutboundLink")],1),e._v(" for more details.")]),e._v(" "),a("h2",{attrs:{id:"the-difference-between-package-and-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-difference-between-package-and-module"}},[e._v("#")]),e._v(" The difference between package and module")]),e._v(" "),a("p",[e._v("I only understand the difference because of writing this post:")]),e._v(" "),a("p",[e._v("In short, a package requires a "),a("code",[e._v("package.json")]),e._v(" to describe it. A module can just be a file or dir which can be loaded by others, and don't require a "),a("code",[e._v("package.json")]),e._v(".\nIt's just like, a husky must be a dog, but a dog can be not a husky.")]),e._v(" "),a("p",[e._v("Head "),a("a",{attrs:{href:"https://docs.npmjs.com/about-packages-and-modules",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm"),a("OutboundLink")],1),e._v(" for more details.")]),e._v(" "),a("p",[e._v("Happy new year.")])])}),[],!1,null,null,null);t.default=n.exports}}]);